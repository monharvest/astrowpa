---
import Layout from '../../components/Layout.astro';
import SEO from '../../components/SEO.astro';
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';

type BlogEntry = CollectionEntry<'blog'>;
const posts = (await getCollection('blog')) as BlogEntry[];
const categories = Array.from(new Set(posts.map((post) => post.data.category)));
const slugify = (value: string) => value.toLowerCase().replace(/\s+/g, '-');
---
<Layout title="Categories - Astro PWA" description="Browse Astro blog posts by category.">
	<SEO
		title="Categories"
		description="Browse Astro blog posts by category."
		image="/pwa-512x512.png"
		url="https://astro-pwa.example.com/categories/"
	/>
	<h1 class="text-3xl font-bold text-slate-900 dark:text-white">Categories</h1>
	<p class="text-sm text-slate-500 dark:text-slate-300">Jump directly into a topic.</p>
	<div class="mt-6 grid gap-4 sm:grid-cols-2">
		{categories.map((category) => (
			<a
				class="rounded-2xl border border-slate-200 bg-white/90 p-6 shadow-card transition hover:-translate-y-1 hover:border-brand-secondary hover:shadow-xl dark:border-slate-700 dark:bg-slate-900/70"
				href={`/categories/${slugify(category)}/`}
			>
				<h2 class="text-xl font-semibold text-slate-900 dark:text-white">{category}</h2>
				<p class="text-sm text-slate-500 dark:text-slate-400">
					{posts.filter((post) => post.data.category === category).length} posts
				</p>
			</a>
		))}
	</div>
</Layout>
